unbind r
bind r source-file ~/.tmux.conf

set -g prefix C-s

set -g mouse on

# Switch panes using vim navigation keys
bind h select-pane -L
bind j select-pane -D
bind k select-pane -U
bind l select-pane -R

# Resize panes by holding prefix and using vim navigation keys
bind -r C-h resize-pane -L 1
bind -r C-j resize-pane -D 1
bind -r C-k resize-pane -U 1
bind -r C-l resize-pane -R 1

# By default, x prompts before killing the pane. This removes the prompt
bind-key x kill-pane
bind-key X kill-window

# Start in same directory when splitting windows
bind % split-window -h -c '#{pane_current_path}'
bind '"' split-window -v -c '#{pane_current_path}'
bind c new-window -c '#{pane_current_path}'

set -g mode-keys vi
bind -n M-Space copy-mode

bind -r f run-shell "tmux new-window -t 99 ~/.tmux/scripts/dev-session.sh"

bind-key C display-popup -E -w 80% -h 80% -T "LLM Chat" "llm chat"

set-option -g status-position bottom

# List of plugins
set -g @plugin 'tmux-plugins/tpm'
set -g @plugin 'tmux-plugins/tmux-online-status'
set -g @plugin 'tmux-plugins/tmux-battery'
set -g @plugin 'erikw/tmux-dark-notify'
set -g @plugin 'christoomey/vim-tmux-navigator'
set -g @plugin '~/.tmux/scripts/vpn_ok'

set -g @dark-notify-theme-path-light "~/.tmux/themes/github-light.conf"
set -g @dark-notify-theme-path-dark "~/.tmux/themes/catppuccin-mocha.conf"

# Configure Online
set -g @online_icon "ok"
set -g @offline_icon "nok"

# status left look and feel
set -g status-left-length 100
set -g status-left ""
set -ga status-left "#{?client_prefix,#{#[bg=#{@thm_red},fg=#{@thm_bg},bold]  #S },#{#[fg=#{@thm_red}]  #S }}"
set -ga status-left "#[bg=#{@thm_bg},fg=#{@thm_border},none]│"
set -ga status-left "#[fg=#{@thm_magenta}]  #{pane_current_command} "
set -ga status-left "#[fg=#{@thm_border},none]│"
set -ga status-left "#[fg=#{@thm_magenta}]  #{=/-32/...:#{s|$USER|~|:#{b:pane_current_path}}} "
set -ga status-left "#[fg=#{@thm_border},none]#{?window_zoomed_flag,│,}"
set -ga status-left "#[fg=#{@thm_magenta}]#{?window_zoomed_flag,  zoom ,}"

# status right look and feel
set -g status-right-length 100
set -g status-right ""
set -ga status-right "#{?#{e|>=:10,#{battery_percentage}},#{#[bg=#{@thm_red}]},#{#[fg=#{@thm_red}]}} #{battery_icon_charge} #{battery_percentage} "
set -ga status-right "#[fg=#{@thm_border}, none]│"
set -ga status-right "#[fg=#{@thm_yellow}]#{?#{==:#(~/.tmux/scripts/vpn_ok.sh),ok}, 󰦝 on , 󰳌 off }"
set -ga status-right "#[fg=#{@thm_border}, none]│"
set -ga status-right "#{?#{==:#{online_status},ok},#[fg=#{@thm_magenta}] 󰖩 on ,#[fg=#{@thm_red},bold]#[reverse] 󰖪 off }"
set -ga status-right "#[fg=#{@thm_border}, none]│"
set -ga status-right "#[fg=#{@thm_blue}] 󰭦 %c "

# Configure Tmux
set -g status-position top
set -g status-justify "absolute-centre"
set -g status-style "bg=#{@thm_bg},fg=#{@thm_fg}"

# pane border look and feel
setw -g pane-border-status top
setw -g pane-border-format ""
setw -g pane-active-border-style "fg=#{@thm_border_active}"
setw -g pane-border-style "fg=#{@thm_border}"
setw -g pane-border-lines single

# window look and feel
set -wg automatic-rename on
set -g automatic-rename-format ""

set -g window-status-format " #I#{?#{!=:#{window_name},Window},: #W,} "
set -g window-status-style "fg=#{@thm_yellow}"
set -g window-status-last-style "fg=#{@thm_yellow}"
set -g window-status-activity-style "bg=#{@thm_red}"
set -g window-status-bell-style "bg=#{@thm_red},bold"
set -gF window-status-separator "#[fg=#{@thm_border}]│"

set -g window-status-current-format " #I#{?#{!=:#{window_name},Window},: #W,} "
set -g window-status-current-style "bg=#{@thm_yellow},fg=#{@thm_bg},bold"

# Copy mode look and feel
set -g mode-style "bg=#{@thm_mode_bg},fg=#{@thm_mode_fg}"

# bootstrap tpm
if "test ! -d ~/.tmux/plugins/tpm" \
   "run 'git clone https://github.com/tmux-plugins/tpm ~/.tmux/plugins/tpm && ~/.tmux/plugins/tpm/bin/install_plugins'"

# Initialize TMUX plugin manager (keep this line at the very bottom of tmux.conf)
run '~/.tmux/plugins/tpm/tpm'

if-shell "test -e ~/.local/state/tmux/tmux-dark-notify-theme.conf" \
     "source-file ~/.local/state/tmux/tmux-dark-notify-theme.conf"

